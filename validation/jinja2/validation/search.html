{#
      Copyright (C) 2018 Eddie Antonio Santos <easantos@ualberta.ca>

      This program is free software: you can redistribute it and/or modify
      it under the terms of the GNU Affero General Public License as
      published by the Free Software Foundation, either version 3 of the
      License, or (at your option) any later version.

      This program is distributed in the hope that it will be useful,
      but WITHOUT ANY WARRANTY; without even the implied warranty of
      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
      GNU Affero General Public License for more details.

      You should have received a copy of the GNU Affero General Public License
      along with this program.  If not, see <http://www.gnu.org/licenses/>.
#}

{#
 # Displays search results for phrases.
 #}

{% extends 'validation/_base.html' %}
{% import 'validation/_macros.html' as macros %}


{% block content %}
<h2> Results for <q>{{ search_term }}</q> </h2>
    {%  for phrase in phrases %}
        <article class="card shadow-sm">
            {% if phrase.validated %}
                <div class="card__header card__header--green" data-phrase-id={{ phrase.id }}>
                &nbsp;
                </div>
            {% else %}
                <div class="card__header card__header--grey" data-phrase-id={{ phrase.id }}>
                &nbsp;
                </div>
            {% endif %}

            <div class="card__body">
                <p class="card__title--cree">{{ phrase.transcription }}</p>
                <p class="card__title--english">Translation: {{ phrase.translation }}</p>
                <p>Is this translation accurate?
                {% if phrase.status == "linked" %}
                    <button class="button button--success-solid translation-judgement-accuracy-yes" data-phrase-id={{ phrase.id }}>Yes</button>
                    <button class="button button--fail translation-judgement-accuracy-no" data-phrase-id={{ phrase.id }}>No</button></p>
                {% else %}
                    <button class="button button--success translation-judgement-accuracy-yes" data-phrase-id={{ phrase.id }}>Yes</button>
                    <button class="button button--fail translation-judgement-accuracy-no" data-phrase-id={{ phrase.id }}>No</button></p>
                {%  endif %}

                <table class="card__body--table">
                    <th>Recording</th>
                    <th>Speaker</th>
                    {% if is_community %}
                        <th>This recording is...</th>
                    {% endif %}

                    {% for recording in phrase.recordings %}
                        <tr>
                            <td>
                                <div class="rec-height">
                                    {{ macros.player(recording) }}
                                </div>
                            </td>
                            <td>
                                {{ macros.speaker(recording) }}
                            </td>
                            {% if is_community %}
                                <td>
                                    <button class="button button--success">Good</button> <button class="button button--fail">Bad</button>
                                </td>
                            {% endif %}
                        </tr>

                    {% endfor %}{# for recording in phrase.recordings #}
                </table>
                {% if is_linguist %}
                    <a href={{ url('validation:segment_detail', phrase.id) }} class="button button--success right">More Options</a>
                {% endif %} {# is linguist #}
            </div>
        </article>
    {% endfor %} {# phrase in phrases #}

    <nav>
      {{ macros.pagination_with_query(phrases, 'validation:search_phrases', query, encode_query_with_page) }}
    </nav>
{% endblock content %}

{# vim: set ft=htmldjango :#}
