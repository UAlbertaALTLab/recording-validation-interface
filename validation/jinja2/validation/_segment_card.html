{#
      Copyright (C) 2021 Jolene Poulin <jcpoulin@ualberta.ca>

      This program is free software: you can redistribute it and/or modify
      it under the terms of the GNU Affero General Public License as
      published by the Free Software Foundation, either version 3 of the
      License, or (at your option) any later version.

      This program is distributed in the hope that it will be useful,
      but WITHOUT ANY WARRANTY; without even the implied warranty of
      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
      GNU Affero General Public License for more details.

      You should have received a copy of the GNU Affero General Public License
      along with this program.  If not, see <http://www.gnu.org/licenses/>.
#}

{% import 'validation/_macros.html' as macros %}

{% macro segment_card(phrase, recordings, is_linguist, is_community) %}

<article class="card shadow-sm">
            {% if phrase.validated %}
                <div class="card__header card__header--green" data-phrase-id={{ phrase.id }}>
                &nbsp;
                </div>
            {% else %}
                <div class="card__header card__header--grey" data-phrase-id={{ phrase.id }}>
                &nbsp;
                </div>
            {% endif %}
            <div class="card__body">
                <p class="card__title--cree">{{ phrase.transcription }}</p>
                <p class="card__title--english">Translation: {{ phrase.translation }}</p>

                {% if is_community %}
                    <p>Is this translation accurate?
                    {% if phrase.status == "linked" %}
                        <button class="button button--success-solid translation-judgement-accuracy-yes" data-phrase-id={{ phrase.id }}>Yes</button>
                        <button class="button button--fail translation-judgement-accuracy-no" data-phrase-id={{ phrase.id }} data-toggle="modal" data-target="#{{ phrase.id }}-modal">No</button>
                        <button class="button button--neutral translation-judgement-accuracy-idk" data-phrase-id={{ phrase.id }}>I don't know</button></p>
                    {% else %}
                        <button class="button button--success translation-judgement-accuracy-yes" data-phrase-id={{ phrase.id }}>Yes</button>
                        <button class="button button--fail translation-judgement-accuracy-no" data-phrase-id={{ phrase.id }} data-toggle="modal" data-target="#{{ phrase.id }}-modal">No</button>
                        <button class="button button--neutral translation-judgement-accuracy-idk" data-phrase-id={{ phrase.id }}>I don't know</button></p>
                    {%  endif %}
                {% endif %} {# check for instructor privileges #}

                <table class="card__body--table">
                    <th>Recording</th>
                    <th>Speaker</th>

                    {% if is_community %}
                        <th>This recording is...</th>
                    {% endif %}

                {% for recording in recordings[phrase] %}
                    <tr>
                        <td>
                            <div class="rec-height">
                            {{ macros.player(recording) }}
                            </div>
                        </td>
                        <td>
                            {{ macros.speaker(recording) }}
                        </td>
                            {% if is_community %}
                                <td>
                                    {% if recording.quality == 'good' %}
                                        <button class="button button--success-solid audio-quality-good" data-rec-id={{ recording.id }}>Good</button>
                                        <button class="button button--fail audio-quality-bad" data-rec-id={{ recording.id }}>Bad</button>
                                    {% elif recording.quality == 'bad' %}
                                        <button class="button button--success audio-quality-good" data-rec-id={{ recording.id }}>Good</button>
                                        <button class="button button--fail-solid audio-quality-bad" data-rec-id={{ recording.id }}>Bad</button>
                                    {% else %}
                                        <button class="button button--success audio-quality-good" data-rec-id={{ recording.id }}>Good</button>
                                        <button class="button button--fail audio-quality-bad" data-rec-id={{ recording.id }}>Bad</button>
                                    {% endif %} {# recording quality #}
                                </td>
                            {% endif %}
                        </tr>

                    {% endfor %}{# for recording in phrase.recordings #}
                </table>
                {% if is_linguist %}
                    <a href={{ url('validation:segment_detail', phrase.id) }} class="button button--success right">More Options</a>
                {% endif %} {# is linguist #}
            </div>

        <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">Something's Wrong</button>

<!-- Modal -->
<div id="{{ phrase.id }}-modal" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">What's wrong with this entry?</h4>
      </div>
      <div class="modal-body">
        <form method="POST" action="#">
            <input type="checkbox" id="recording" name="recording" value="recording">
            <label for="recording"> This is not a recording of this word</label><br>
            <input type="checkbox" id="transcription" name="transcription" value="transcription">
            <label for="transcription"> There's a better Cree word for this English word</label><br>
            <input type="checkbox" id="translation" name="translation" value="translation">
            <label for="translation"> There's a better English word for this Cree word</label><br>
            <input type="checkbox" id="other" name="other" value="other">
            <label for="other"> Something else:</label>
            <input class="form-control mr-sm-2" name="other" type="search" placeholder="Please specify" aria-label="Search"><br>
            Comments: <input type="text" id="comments" name="comments">
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="close" data-dismiss="modal">bye</button>
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>
        </article>

{% endmacro %}